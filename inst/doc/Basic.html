<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kyungsub Lee" />

<meta name="date" content="2017-08-24" />

<title>Basic example</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Basic example</h1>
<h4 class="author"><em>Kyungsub Lee</em></h4>
<h4 class="date"><em>2017-08-24</em></h4>



<div id="install-pacakge" class="section level3">
<h3>Install pacakge</h3>
<p>To install <code>mHawkes</code> package, first install <code>devtools</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;devtools&quot;)  #if devtools is not installed</span></code></pre></div>
<p>Install <code>mHawkes</code> package from github.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#devtools::install_github(&quot;ksublee/mHawkes&quot;, build_vignettes=FALSE, force=TRUE)</span></code></pre></div>
<p>Load <code>mHawkes</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;mHawkes&quot;</span>)</code></pre></div>
</div>
<div id="one-dimensional-hawkes-process" class="section level3">
<h3>one dimensional Hawkes process</h3>
<p>First, create a mHSpec which defines the Hawkes model. Basically the model can be defined up to 9 dimension but currently fully supported for one and two diemsional model especillay for estimation. The parameter of the model is defined by a matrix but numeric vectors are also supported for one dimesional model.</p>
<p>The following is an example of one dimensional Hawkes model (without mark). Parameter inputs can be a numeric vector or 1 by 1 matrix. In the following case Jump and eta slots, which deteremine the mark, are default values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MU1 &lt;-<span class="st"> </span><span class="fl">0.3</span>
ALPHA1 &lt;-<span class="st"> </span><span class="fl">1.5</span>
BETA1 &lt;-<span class="st"> </span><span class="dv">2</span>
mHSpec1 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;mHSpec&quot;</span>, <span class="dt">MU=</span>MU1, <span class="dt">ALPHA=</span>ALPHA1, <span class="dt">BETA=</span>BETA1)
<span class="kw">show</span>(mHSpec1)</code></pre></div>
<pre><code>## 1-dimensional (marked) Hawkes model with linear impact function.
## The intensity process is defined by
## 
## LAMBDA(t) = MU + int ALPHA %/% BETA (1+(k-1)ETA) %*% exp(-BETA(t-u)) d N(t)
## 
## Parameters: 
## 
## MU: 
## [1] 0.3
## 
## ALPHA: 
## [1] 1.5
## 
## BETA: 
## [1] 2
## 
## ETA: 
## [1] 0
## 
## Mark distribution: 
## function(n,...) rep(1,n)
## &lt;environment: 0x00000000109383b8&gt;
## ------------------------------------------</code></pre>
<p>To simulate, use function <code>mHSim</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res1 &lt;-<span class="st"> </span><span class="kw">mHSim</span>(mHSpec1,  <span class="dt">n=</span><span class="dv">20</span>)</code></pre></div>
<p>The output <code>res1</code> is a list of <code>inter_arrival</code>, <code>arrival</code>, <code>jump_type</code>, <code>mark</code>,<code>N</code>, <code>Ng</code>, <code>lambda</code>, and <code>lambda_component</code>. <code>inter_arrival</code>, <code>arrival</code>, <code>jump_type</code>, and <code>mark</code> are numeric vectors and <code>N</code>, <code>Ng</code>, <code>lambda</code>, and <code>lambda_component</code> are matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res1</code></pre></div>
<pre><code>## ------------------------------------------
## Simulation result of marked Hawkes model.
## 1-dimensional (marked) Hawkes model with linear impact function.
## The intensity process is defined by
## 
## LAMBDA(t) = MU + int ALPHA %/% BETA (1+(k-1)ETA) %*% exp(-BETA(t-u)) d N(t)
## 
## Parameters: 
## 
## MU: 
## [1] 0.3
## 
## ALPHA: 
## [1] 1.5
## 
## BETA: 
## [1] 2
## 
## ETA: 
## [1] 0
## 
## Mark distribution: 
## function(n,...) rep(1,n)
## &lt;environment: 0x00000000109383b8&gt;
## ------------------------------------------
## Realized path (with right continuous representation):
##         arrival N1  lambda1 lambda11
##  [1,] 0.0000000  0 0.750000 0.450000
##  [2,] 0.9964132  1 1.861339 1.561339
##  [3,] 2.2332102  2 1.931592 1.631592
##  [4,] 2.4556665  3 2.845655 2.545655
##  [5,] 2.4638128  4 4.304516 4.004516
##  [6,] 2.7848949  5 3.906986 3.606986
##  [7,] 2.7855831  6 5.402025 5.102025
##  [8,] 3.1583007  7 4.221052 3.921052
##  [9,] 3.1619829  8 5.692282 5.392282
## [10,] 3.1794561  9 7.007095 6.707095
## [11,] 3.3040018 10 7.028240 6.728240
## [12,] 3.3311588 11 8.172549 7.872549
## [13,] 3.8490483 12 4.594360 4.294360
## [14,] 4.2186801 13 3.850408 3.550408
## [15,] 4.9302635 14 2.655470 2.355470
## [16,] 5.2659567 15 3.003644 2.703644
## [17,] 7.9057405 16 1.813774 1.513774
## [18,] 8.1262258 17 2.773980 2.473980
## [19,] 8.9745456 18 2.253477 1.953477
## [20,] 9.1164514 19 3.270789 2.970789
## ------------------------------------------</code></pre>
<p>Note that the <code>inter_arrival</code> and <code>arrival</code> start at zero. Thus, <code>inter_arrival[2]</code> and <code>arrival[2]</code> are first arrival time.</p>
<p>Simle way to plot the realized processes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot(res1$arrival, res1$N[,'N1'], 's', xlab=&quot;t&quot;, ylab=&quot;N&quot;)</span></code></pre></div>
<p>Intensity process can be plotted by <code>plotlambda</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plotlambda(res1$arrival, res1$N[,'N1'], BETA1)</span></code></pre></div>
<p>The log-likelihood function is computed by <code>logLik</code> function. In this case, the inter-arrival times and <code>mHSpec</code> are inputs of the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inter_arrival1 &lt;-<span class="st"> </span>res1<span class="op">$</span>inter_arrival
<span class="kw">logLik</span>(mHSpec1, <span class="dt">inter_arrival =</span> inter_arrival1)</code></pre></div>
<pre><code>## [1] -4.358598</code></pre>
<p>The likelihood estimation is performed using <code>mHFit</code> function. The specification of the initial values of the parameters, <code>mHSpec0</code> is needed. In this example, <code>mHSpec0</code> is set to be ``<code>mHspec1</code> for simplicity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mHSpec0 &lt;-<span class="st"> </span>mHSpec1
mle &lt;-<span class="st"> </span><span class="kw">mHFit</span>(mHSpec0, <span class="dt">inter_arrival =</span> inter_arrival1)
<span class="kw">summary</span>(mle)</code></pre></div>
<pre><code>## --------------------------------------------
## Maximum Likelihood estimation
## BFGS maximization, 21 iterations
## Return code 0: successful convergence 
## Log-Likelihood: -2.735999 
## 3  free parameters
## Estimates:
##        Estimate Std. error t value Pr(&gt; t)  
## mu1      1.0897     0.5805   1.877  0.0605 .
## alpha1   1.2582     0.9945   1.265  0.2058  
## beta1    2.5373     2.0605   1.231  0.2182  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------</code></pre>
</div>
<div id="one-dimensional-hawkes-process-with-jump" class="section level3">
<h3>one dimensional Hawkes process with jump</h3>
<p>Mark structure can be added with Jump slot. In addition, linear impact parameter <code>ETA</code> can be added.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ETA1 &lt;-<span class="st"> </span><span class="fl">0.15</span>
JUMP1 &lt;-<span class="st"> </span><span class="cf">function</span>(n,...) <span class="kw">rgeom</span>(n, <span class="fl">0.65</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>

mHSpec1 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;mHSpec&quot;</span>, <span class="dt">MU=</span>MU1, <span class="dt">ALPHA=</span>ALPHA1, <span class="dt">BETA=</span>BETA1, <span class="dt">ETA=</span>ETA1, <span class="dt">Jump =</span>JUMP1)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res1 &lt;-<span class="st"> </span><span class="kw">mHSim</span>(mHSpec1,  <span class="dt">n=</span><span class="dv">10</span>)</code></pre></div>
<p>Plot the realized processes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot(res1$arrival, res1$N[,'N1'], 's', xlab=&quot;t&quot;, ylab=&quot;N&quot;)</span></code></pre></div>
</div>
<div id="two-dimensional-hawkes-model" class="section level3">
<h3>Two-dimensional Hawkes model</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MU2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)
ALPHA2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">0.92</span>, <span class="fl">0.92</span>, <span class="fl">0.75</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
BETA2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
ETA2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.19</span>, <span class="fl">0.19</span>, <span class="fl">0.19</span>, <span class="fl">0.19</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
JUMP2 &lt;-<span class="st"> </span><span class="cf">function</span>(n,...) <span class="kw">rgeom</span>(n, <span class="fl">0.65</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
LAMBDA0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
mHSpec2 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;mHSpec&quot;</span>, <span class="dt">MU=</span>MU2, <span class="dt">ALPHA=</span>ALPHA2, <span class="dt">BETA=</span>BETA2, <span class="dt">ETA=</span>ETA2, <span class="dt">Jump =</span>JUMP2)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mHSpec2</code></pre></div>
<pre><code>## 2-dimensional (marked) Hawkes model with linear impact function.
## The intensity process is defined by
## 
## LAMBDA(t) = MU + int ALPHA %/% BETA (1+(k-1)ETA) %*% exp(-BETA(t-u)) d N(t)
## 
## Parameters: 
## 
## MU: 
##      [,1]
## [1,]  0.2
## [2,]  0.2
## 
## ALPHA: 
##      [,1] [,2]
## [1,] 0.75 0.92
## [2,] 0.92 0.75
## 
## BETA: 
##      [,1] [,2]
## [1,] 2.25 2.25
## [2,] 2.25 2.25
## 
## ETA: 
##      [,1] [,2]
## [1,] 0.19 0.19
## [2,] 0.19 0.19
## 
## Mark distribution: 
## function(n,...) rgeom(n, 0.65) + 1
## ------------------------------------------</code></pre>
<p>To simulate, use function <code>mHSim</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res2 &lt;-<span class="st"> </span><span class="kw">mHSim</span>(mHSpec2,  <span class="dt">n=</span><span class="dv">100</span>)
<span class="kw">summary</span>(res2)</code></pre></div>
<pre><code>## ------------------------------------------
## Simulation result of marked Hawkes model.
## Realized path (with right continuous representation):
##          arrival N1 N2   lambda1   lambda2
##  [1,]  0.0000000  0  0 0.7758621 0.7758621
##  [2,]  0.9895787  0  2 1.3569354 1.1546354
##  [3,]  5.7025606  0  3 1.1200287 0.9500237
##  [4,]  5.9917630  2  3 1.5724584 1.6860706
##  [5,]  6.0051425  2  4 2.4517576 2.3920006
##  [6,]  6.0088355  4  4 3.3256251 3.4686625
##  [7,]  6.0582494  4  5 3.9167355 3.8747220
##  [8,]  6.2599919  5  5 3.3106220 3.4539378
##  [9,]  6.4933807  5  6 2.9598757 2.8746444
## [10,]  7.4572034  7  6 1.4080572 1.6006120
## [11,]  7.5149330  8  6 2.0109045 2.3500044
## [12,]  8.1314610  9  6 1.4023217 1.6570209
## [13,]  8.4644441  9  8 1.8631843 1.7812906
## [14,]  8.5175606  9  9 2.5958321 2.3531634
## [15,] 12.4440359  9 10 1.1203489 0.9503135
## [16,] 15.8830882  9 11 1.1204013 0.9503271
## [17,] 18.5391533 11 11 1.0948365 1.2967048
## [18,] 22.5844251 12 11 0.9500997 1.1201222
## [19,] 24.2293325 13 11 0.9685258 1.1427250
## [20,] 24.6780381 14 11 1.2300272 1.4635000
## ... with 80 more rows 
## ------------------------------------------</code></pre>
<p>Plot N.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot(res2$arrival[1:10], res2$N[1:10,1], 's')</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot(res2)</span></code></pre></div>
<p>Plot lambda.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plotlambda(res2$arrival[1:10], res2$lambda[1:10,1], BETA2[1,1])</span></code></pre></div>
<p>Frome the result, we get a vector of realized inter arrival times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inter_arrival1 &lt;-<span class="st"> </span>res1<span class="op">$</span>inter_arrival</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mle &lt;-<span class="st"> </span><span class="kw">mHFit</span>(mHSpec1, <span class="dt">inter_arrival =</span> inter_arrival1)</code></pre></div>
<p>Frome the result, we get a vector of realized inter arrival times.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inter_arrival2 &lt;-<span class="st"> </span>res2<span class="op">$</span>inter_arrival
mark2 &lt;-<span class="st"> </span>res2<span class="op">$</span>mark
jump_type2 &lt;-<span class="st"> </span>res2<span class="op">$</span>jump_type</code></pre></div>
<p>Log-likelihood is computed by a function <code>logLik</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logLik</span>(mHSpec2,  <span class="dt">inter_arrival =</span> inter_arrival2, <span class="dt">jump_type =</span> jump_type2, <span class="dt">mark =</span> mark2)</code></pre></div>
<pre><code>## [1] -41.00693</code></pre>
<p>A log-likelihood estimation is performed using <code>mHFit</code>. <code>mSpec0</code> is regarded as a starting point of the numerical optimization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mHSpec0 &lt;-<span class="st"> </span>mHSpec2
mle &lt;-<span class="st"> </span><span class="kw">mHFit</span>(mHSpec0, <span class="dt">inter_arrival =</span> inter_arrival2, <span class="dt">jump_type =</span> jump_type2, <span class="dt">mark =</span> mark2)
<span class="kw">summary</span>(mle)</code></pre></div>
<pre><code>## --------------------------------------------
## Maximum Likelihood estimation
## BFGS maximization, 35 iterations
## Return code 0: successful convergence 
## Log-Likelihood: -40.09056 
## 5  free parameters
## Estimates:
##         Estimate Std. error t value Pr(&gt; t)   
## mu1      0.24940    0.08856   2.816 0.00486 **
## alpha11  0.43128    0.25485   1.692 0.09060 . 
## alpha12  0.82741    0.37795   2.189 0.02858 * 
## beta11   1.95571    0.64442   3.035 0.00241 **
## eta11    0.50188    0.50597   0.992 0.32124   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------</code></pre>
<p>The parameters to be estimated depends on <code>mHSpec0</code>. For example, if <code>MU[1]</code> and <code>MU[2]</code> are different, then both parameters are estimated. If <code>MU[1]</code> and <code>MU[2]</code> are equal, then two parameters are assumed to be the same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MU0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.21</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)
ALPHA0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
BETA0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">2.25</span>, <span class="fl">2.251</span>, <span class="fl">2.251</span>, <span class="fl">2.25</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
ETA0 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.19</span>, <span class="fl">0.19</span>, <span class="fl">0.19</span>, <span class="fl">0.19</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
JUMP0 &lt;-<span class="st"> </span><span class="cf">function</span>(n,...) <span class="kw">rgeom</span>(n, <span class="fl">0.65</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>

mHSpec0 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;mHSpec&quot;</span>, <span class="dt">MU=</span>MU0, <span class="dt">ALPHA=</span>ALPHA0, <span class="dt">BETA=</span>BETA0, <span class="dt">ETA=</span>ETA0, <span class="dt">Jump =</span>JUMP0)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mle &lt;-<span class="st"> </span><span class="kw">mHFit</span>(mHSpec0, <span class="dt">inter_arrival =</span> inter_arrival2, <span class="dt">jump_type =</span> jump_type2, <span class="dt">mark =</span> mark2)
<span class="kw">summary</span>(mle)</code></pre></div>
<pre><code>## --------------------------------------------
## Maximum Likelihood estimation
## BFGS maximization, 30 iterations
## Return code 0: successful convergence 
## Log-Likelihood: -39.51162 
## 6  free parameters
## Estimates:
##         Estimate Std. error t value Pr(&gt; t)   
## mu1      0.32032    0.13684   2.341 0.01924 * 
## mu2      0.18435    0.09801   1.881 0.05998 . 
## alpha11  0.75203    0.38056   1.976 0.04814 * 
## beta11   4.21122    4.04250   1.042 0.29753   
## beta12   1.55807    0.55083   2.829 0.00468 **
## eta11    0.43172    0.47915   0.901 0.36758   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
