}
}
basis <- dataset1[i, 2]
basis_idx <- i
d_num <- 1
}
}
# duplicated time handling
basis <- dataset2[1, 2][[1]]
basis_idx <- 1
d_num <- 1
for (i in 2:nrow(dataset2)){
if(dataset2[i, 2][[1]] == basis){
d_num <- d_num + 1
} else {
if(d_num > 1){
for (j in (basis_idx+1):(i-1)){
dataset2[j, 2] <- basis + (j - basis_idx)/d_num
}
}
basis <- dataset2[i, 2]
basis_idx <- i
d_num <- 1
}
}
outer_joined <- full_join(dataset1, dataset2, by = "Time") %>%
select(Time, Price.x, Price.y) %>%
arrange(Time)
for (i in 2:nrow(outer_joined)) {
if (is.na(outer_joined[i,2])){
outer_joined[i,2] = outer_joined[i-1,2]
}
if (is.na(outer_joined[i,3])){
outer_joined[i,3] = outer_joined[i-1,3]
}
}
outer_joined <- outer_joined[complete.cases(outer_joined),]
outer_joined <- filter(outer_joined, 3600*10 <= Time & Time <= 3600*16)
arrival <- outer_joined[,1][[1]]
arrival <- arrival - arrival[1]
inter_arrival <- c(0, arrival[-1] - arrival[-length(arrival)])
#C1 <- c(outer_joined[,2][[1]])
#C2 <- c(outer_joined[,3][[1]])
C1 <- numeric(0)
C2 <- numeric(0)
#for (i in seq(3600*10,3600*16, 3600)){
interv <- 600
for (i in seq(3600*10,3600*16, interv)){
C1_part <- (filter(outer_joined, i <= Time & Time < i + interv) %>%
select(Price.x))[[1]]
C2_part <- (filter(outer_joined, i <= Time & Time < i + interv) %>%
select(Price.y))[[1]]
mean_diff <- round(mean(C1_part - C2_part), 2)
#print(mean_diff)
C1_part <- C1_part - mean_diff
C1 <- c(C1, C1_part)
C2 <- c(C2, C2_part)
}
#mean_diff <- round(mean(C1 - C2), 2)
#C1 <- C1 - mean_diff
mark_type <- numeric(length(inter_arrival))
for (i in 2:length(mark_type)){
if (C1[i] > C1[i-1]){
mark_type[i] = 1
} else if ( C1[i] < C1[i-1] ){
mark_type[i] = 2
} else if ( C2[i] > C2[i-1] ){
mark_type[i] = 3
} else {
mark_type[i] = 4
}
}
LAMBDA0 <- matrix(c(0.2,0.2,0.2,0.2), nrow=2, byrow=TRUE)
#logLik(c(0.2, 0.2, 1, 2))
ml <- maxLik(logLik, start = c(0.2, 0.2, 0.5, 0.5, 2), method="BFGS")
summary(ml)
if (k==1) {
result_matrix <- matrix(c(paste0(toString(y0), selected_month,  toString(d)), coef(ml), stdEr(ml)), ncol = 11, byrow=TRUE)
} else {
result_matrix <- rbind(result_matrix, c(paste0(toString(y0), selected_month,  toString(d)), coef(ml), stdEr(ml)))
}
}
colnames(result_matrix) <- c("date", "mu1", "mu2", "alpha1", "alpha2", "beta", "se", "se", "se", "se")
write_csv(as_tibble(result_matrix), "C:/Users/kyung/cloud/Dropbox/data/Oil/tick/temp_estimation_two_alpha.csv")
devtools::load_all(".")
rm(list=ls())
devtools::load_all(".")
dependent_mark <- function(n, i, lambda = lambda, mark_type = mark_type, ...){
c <- 0.15
d <- 1
U <- 2
p <- 1 / min(d + c*lambda[i, mark_type[i]], U)
rgeom(n, p) + 1
}
MU2 <- matrix(c(0.2, 0.2), nrow = 2)
ALPHA2 <- matrix(c(0.75, 0.90, 0.90, 0.75), nrow = 2, byrow=TRUE)
BETA2 <- matrix(c(2.5, 2.5, 2.5, 2.5), nrow = 2, byrow=TRUE)
ETA2 <- matrix(c(0.19, 0.19, 0.19, 0.19), nrow = 2, byrow=TRUE)
mhspec2 <- new("mhspec", MU=MU2, ALPHA=ALPHA2, BETA=BETA2, ETA=ETA2, mark=dependent_mark)
summary(res2 <- mhsim(mhspec2, n=5000))
summary(mhfit(mhspec2, arrival = res2$arrival, N = res2$N))
set.seed(1107)
mhspec1 <- new("mhspec", MU=0.3, ALPHA=1.2, BETA=1.5)
show(mhspec1)
ALPHA1
ALPHA2
ALPHA2 == 0
all(ALPHA2 == 0)
temp <- matrix(c(0,0,0,0), nrow=2)
all(temp == 0)
devtools::load_all(".")
set.seed(1107)
mhspec1 <- new("mhspec", MU=0.3, ALPHA=1.2, BETA=1.5)
show(mhspec1)
res1
devtools::load_all(".")
# install.packages("devtools")  #if devtools is not installed
# devtools::install_github("ksublee/mhawkes")
library("mhawkes")
mhsim()
set.seed(1107)
mhspec1 <- new("mhspec", MU=0.3, ALPHA=1.2, BETA=1.5)
show(mhspec1)
res1 <- mhsim(mhspec1,  n=5000)
res1
summary(res1)
plot(res1$arrival[1:20], res1$N[,'N1'][1:20], 's', xlab="t", ylab="N")
plot_lambda(res1$arrival[1:20], res1$N[,'N1'][1:20], BETA1)
plot_lambda(res1$arrival[1:20], res1$N[,'N1'][1:20], mhspec1$BETA)
plot_lambda(res1$arrival[1:20], res1$N[,'N1'][1:20], mhspec1@BETA)
logLik(mhspec1, inter_arrival = res1$inter_arrival)
mhspec0 <- mhspec1
mle <- mhfit(mhspec0, inter_arrival = res1$inter_arrival)
summary(mle)
summary(mhfit(inter_arrival = res1$inter_arrival))
summary(mhfit(mhspec0, inter_arrival = res1$inter_arrival, method = "NR"))
my_llh <- function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type2, mark = mark2)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
my_llh <- function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
my_llh <- function(param, ...){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
MU2 <- matrix(c(0.2), nrow = 2)
ALPHA2 <- matrix(c(0.75, 0.92, 0.92, 0.75), nrow = 2, byrow=TRUE)
BETA2 <- matrix(c(2.25, 2.25, 2.25, 2.25), nrow = 2, byrow=TRUE)
ETA2 <- matrix(c(0.19, 0.19, 0.19, 0.19), nrow = 2, byrow=TRUE)
mark2 <- function(n,...) rgeom(n, 0.65) + 1
LAMBDA0 <- matrix(c(0.1, 0.1, 0.1, 0.1), nrow = 2, byrow=TRUE)
mhspec2 <- new("mhspec", MU=MU2, ALPHA=ALPHA2, BETA=BETA2, ETA=ETA2, mark =mark2)
res2 <- mhsim(mhspec2,  n=5000)
inter_arrival2 <- res2$inter_arrival
mark2 <- res2$mark
mark_type2 <- res2$mark_type
my_llh <- function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
mhspec0
MU0 <- matrix(c(0.15, 0.15), nrow = 2)
ALPHA0 <- matrix(c(0.75, 0.751, 0.751, 0.75), nrow = 2, byrow=TRUE)
BETA0 <- matrix(c(2.6, 2.6, 2.6, 2.6), nrow = 2, byrow=TRUE)
ETA0 <- matrix(c(0.2, 0.2, 0.2, 0.2), nrow = 2, byrow=TRUE)
mark0 <- function(n,...) rgeom(n, 0.65) + 1
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0, mark =mark0)
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
a <- llh_fun
my_llh <- function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
a <- function(x, y) x + y
a(1,2)
b <- a(y=1)
b <- function(x) a(x, y=1)
b(x)
b(1)
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
my_llh <- function(param, inter_arrival, mark_type, mark, ...){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
my_llh <- function(param, ...){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
test <- function(x, ...) y
test(1)
test(1, y=1)
test <- function(x, ...) dots <- list(...)
test(1, y=1)
c <- test(1, y=1)
c
my_llh <- function(param, ...){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
realizations <- list(...)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = realizations$inter_arrival, mark_type = realizations$mark_type, mark = realizations$mark)
}
devtools::load_all(".")
summary(mhfit(mhspec0, llh=my_llh, inter_arrival = res2$inter_arrival, N = res2$N))
print(my_llh)
my_llh(1,2,3,4)
my_llh(0.1,0,1,0,3,0.5, inter_arrival = res2$inter_arrival, N = res2$N)
summary(maxLik::maxLik(my_llh, start=c(0.15, 0.75, 2.6), methods="BFGS"))
summary(maxLik::maxLik(my_llh, start=c(0.15, 0.75, 2.6), methods="BFGS"))
my_llh <- function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival2, mark_type = mark_type2, mark = mark2)
}
summary(maxLik::maxLik(my_llh, start=c(0.15, 0.75, 2.6), methods="BFGS"))
summary(maxLik::maxLik(my_llh, start=c(0.15, 0.75, 2.6), method="BFGS"))
summary(maxLik::maxLik(my_llh, start=c(0.15, 0.75, 0.8, 2.6), method="BFGS"))
summary(maxLik::maxLik(my_llh, start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival = inter_arrival2, mark_type = mark_type2, mark = mark2){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival2, mark_type = mark_type2, mark = mark2)
}
summary(maxLik::maxLik(my_llh, start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival = inter_arrival2, mark_type = mark_type2, mark = mark2){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(my_llh, start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(my_llh, start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
summary(maxLik::maxLik(my_llh(inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
summary(maxLik::maxLik(logLik=my_llh(inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
summary(maxLik::maxLik(logLik <- function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
summary(maxLik::maxLik(logLik = function(param) sum(param),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
mark2
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
sum(param) + inter_arrival[1]
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
inter_arrival[1]
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
inter_arrival[1] + mark_type[1] + mark[1]
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
devtools::load_all(".")
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
devtools::load_all(".")
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
print(inter_arrival[1])
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
print(inter_arrival[2])
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0)
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
devtools::load_all(".")
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhspec0$MU[1]
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhspec0@MU[1]
#logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(param, inter_arrival, mark_type, mark){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhawkes::logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
summary(maxLik::maxLik(logLik = function(param) my_llh(param, inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
library(mhawkes)
my_llh <- function(inter_arrival, mark_type, mark){
function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhawkes::logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
}
summary(maxLik::maxLik(logLik = my_llh(inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2),
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
my_llh <- function(inter_arrival, mark_type, mark){
function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhawkes::logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
}
my_llh_fun <- my_llh(inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2)
my_llh_fun(c(0.1,0.2,0.2,0.9))
summary(maxLik::maxLik(my_llh_fun,
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
inter_arrival2 <- res2$inter_arrival
mark2 <- res2$mark
mark_type2 <- res2$mark_type
my_llh <- function(inter_arrival, mark_type, mark){
function(param){
MU0 <- matrix(rep(param[1], 2), nrow=2)
ALPHA0 <- matrix(c(param[2], param[3], param[3], param[2]), nrow = 2, byrow=TRUE)
BETA0 <- matrix(rep(param[4], 4), nrow = 2, byrow=TRUE)
ETA0 <- matrix(rep(0.2, 4), nrow=2)
mhspec0 <- new("mhspec", MU=MU0, ALPHA=ALPHA0, BETA=BETA0, ETA=ETA0)
mhawkes::logLik(mhspec0, inter_arrival = inter_arrival, mark_type = mark_type, mark = mark)
}
}
my_llh_fun <- my_llh(inter_arrival=inter_arrival2, mark_type=mark_type2, mark=mark2)
summary(maxLik::maxLik(my_llh_fun,
start=c(mu1=0.15, alpha11=0.75, alpha12=0.8, beta=2.6), method="BFGS"))
